#!/usr/bin/php
<?php
ini_set('display_errors', TRUE);
error_reporting(E_ALL & ~E_NOTICE);
ini_set('log_errors', FALSE);
if(!defined('STDERR'))
	define(STDERR, fopen('php://stderr', 'w'));
if(!defined('STDIN'))
	define(STDIN, fopen('php://stdin', 'r'));

$xml=implode("", file('php://stdin'));
echo requestCurl($xml);
exit(0);

function requestCurl($data)
{
	$ch=curl_init('https://gateway.autodns.com');
	$options=array(
		CURLOPT_POSTFIELDS => $data,
		CURLOPT_RETURNTRANSFER => true,
		CURLOPT_USERAGENT => 'Mozilla/5.0 (Windows NT 6.1; WOW64; rv:10.0.2) Gecko/20100101 Firefox/10.0.2',
		CURLOPT_FOLLOWLOCATION => true,
		CURLOPT_MAXREDIRS => 8,
		CURLOPT_HTTP_VERSION => CURL_HTTP_VERSION_1_1,
		CURLOPT_SSL_VERIFYPEER => true,
		CURLOPT_SSL_VERIFYHOST => 2,
	);
	curl_setopt_array($ch, $options);
	if(!$data=curl_exec($ch))
	{
		echo 'Curl execution error.'.curl_error($ch)."\n";
		return FALSE;
	}
	curl_close($ch);
	return $data;
}
?>
